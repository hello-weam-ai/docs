---
title: AI-SEO-Generator
description: Concise overview of the SEO content generation project, its architecture, APIs, data, and best practices.
sidebarTitle: AI-SEO-Gen
---

### Overview

SEO Content Gen is a multi-service application for planning and generating SEO content. It combines a React frontend, a NestJS API, and a FastAPI service to support article ideation, content drafting, site audits, and content review workflows.

### What it does (Capabilities)

- **Article and project management**: Create and manage projects and articles, including titles, keywords, and outlines.
- **Rich text editor**: BlockNote-based editor module with toolbars, focus mode, sidebars, checks, and share/export options.
- **SEO audit workflow**: Chunked, real-time progress updates for site audits and final report handling.
- **Sitemap discovery and analysis**: Resolve `sitemap.xml` or `sitemap_index.xml`, discover URLs, and analyze pages in batches.
- **Web scraping for references**: Google Custom Search + Playwright scraping to gather reference URLs and content signals.
- **AI summaries and content**: Generate content via OpenAI, Gemini, and Claude with references appended.
- **OCR extract**: Extract text from PDF/DOCX/DOC (DOC via LibreOffice conversion) for content ingestion.
- **Auth and rate limiting**: JWT-based guards in the Node API with throttling and security middleware.

### User flows

- **Plan content**: Define a project, keywords, and titles; optionally fetch suggested titles and outlines.
- **Draft & edit**: Use the editor to draft content with toolbar options and writing checks.
- **Reference & cite**: Pull reference links via scraping; add citations and review sources.
- **Audit site**: Run site audits and monitor progress in real time; view the final audit report once complete.
- **Export & share**: Export or share content from the editor with role-based controls.

### Architecture

- **Frontend (React + Vite)**: The UI in `frontend/` provides project/article pages, the editor module (`src/modules/editor/`), and utilities. It communicates with the Node API using a configurable base URL.
- **Node API (NestJS)**: The main API in `node/` exposes domain modules for projects, articles, prompts, and streaming updates (SSE). It uses MongoDB via Mongoose and applies Helmet, CORS, and rate limiting.
- **Python API (FastAPI)**: The service in `backend_python/` handles scraping, sitemap analysis, AI summarization, OCR, and the SEO Audit router with chunked updates.
- **Data store**: MongoDB via Mongoose/Motor stores projects, articles, prompts, guidelines, and audit records.
- **External services**: OpenAI, Gemini, Claude, Google Custom Search; Playwright for page rendering.

### Technical design

- **Modules & features (Node)**:
  - `projects`, `articles`, `article-documents`, `guidelines`, `system-prompts`, `prompt-types`, `sse`, `webhooks`, `openai`, `claude`, `gemini`.
  - Global prefix `seo-content-api`; Helmet, CORS, throttling; JWT guards.
- **Pipelines (Python)**:
  - **SEO audit**: Single endpoint streams progress; final report stored with status and steps.
  - **Sitemap analysis**: Discover → batch analyze with concurrency limits → attach content types.
  - **Reference scraping**: Google Custom Search → Playwright extraction → clean content → dedupe → append citations.
  - **Summarization**: Generate content via OpenAI/Gemini/Claude; return with references, optionally via webhooks to the Node API.
- **Session/state**: Frontend uses `zustand` for state and `react-query` for fetching; Node uses JWT guards. No multi-tenant specifics stated.
- **Security & validation**:
  - Helmet, CORS, throttling (`@nestjs/throttler`).
  - Validation in Python endpoints for ObjectId formats and input shapes; global exception handling in Node.

### API reference (high level)

- **Node API (NestJS, prefixed with `seo-content-api`)**:
  - Projects, Articles, Article Documents, Guidelines, System Prompts, Prompt Types, SSE, Webhooks, AI providers (OpenAI/Claude/Gemini)
  - Auth: JWT-based guards; rate limiting enabled.
  - Exact routes: Not applicable.
- **Python API (FastAPI)**:
  - `GET /health`: Service/Mongo health.
  - `POST /company-business-summary`: Summarize company details.
  - `POST /target-audience`: Generate target audience from details.
  - `POST /generate-outline`: Generate content preview/outline for an article by ID.
  - `POST /fetch-sitemaps`: Locate sitemap and summarize counts.
  - `POST /sitemap`: Discover URLs and analyze in batches; returns annotated results.
  - `POST /get-titles`: Generate SEO titles per keyword and prompt types; similarity checks.
  - `POST /check-title`: Check if a title already exists within a project.
  - `POST /file-ocr`: Extract text from documents (PDF/DOCX/DOC).
  - `router /seo-audit/*`: SEO Audit endpoints (progress and final report).

### Data and schemas (conceptual)

- **Project**: Name, website URL, language, location, targeted audience, guideline reference, additional brand fields.
- **Article**: Name (title), keywords, secondary keywords, project reference, generated outline, scraped content metadata.
- **Guideline/System Prompt/Prompt Type**: Stored prompt texts and relationships used for content generation.
- **SEO Audit**: Status, current step, progress steps, final `audit_report`, error message.
- **Users/Auth**: JWT-only single-user assumptions; no multi-tenant fields stated.

### Troubleshooting

<Tabs items={["SEO Audit", "Scraping & References", "Sitemap Analysis", "Editor & UI", "API & Auth", "Performance & Limits"]}>
  <Tabs.Tab>
    <AccordionGroup>
      <Accordion title="Audit never completes">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Progress stalls at a step</li>
            <li>No final report stored</li>
            <li>Frontend shows in-progress indefinitely</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Timeouts during chunked processing</li>
            <li>Network/stream parsing errors</li>
            <li>Background scheduler not updating failed audits</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Check scheduler logs; confirm stuck audits are marked failed</li>
            <li>Reduce timeouts or chunk sizes if applicable</li>
            <li>Verify router integration under `/seo-audit`</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Audit progress missing steps">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Only final status appears</li>
            <li>No `progress_steps` saved</li>
            <li>UI lacks granular updates</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Parser ignoring non-JSON lines</li>
            <li>Stream buffering</li>
            <li>Schema changes not reflected in code</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Ensure each progress line is appended to `progress_steps`</li>
            <li>Flush handlers more frequently</li>
            <li>Re-run migration aligning with `SITE_AUDIT_FLOW.md`</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Audit reports fail to save">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Final JSON lost</li>
            <li>DB record lacks `audit_report`</li>
            <li>Error message populated</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>JSON framing after "Done." not parsed</li>
            <li>DB validation error</li>
            <li>Connectivity to Mongo</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Handle the post-"Done." JSON explicitly</li>
            <li>Validate schema fields before insert/update</li>
            <li>Verify database connectivity and indexes</li>
          </ul>
        </div>
      </Accordion>
    </AccordionGroup>
  </Tabs.Tab>
  <Tabs.Tab>
    <AccordionGroup>
      <Accordion title="No reference URLs returned">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Empty list from Google search</li>
            <li>Scraping job completes instantly</li>
            <li>No citations appended</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Missing/invalid `CUSTOM_GOOGLE_SEARCH` or `CX_ID`</li>
            <li>Query too restrictive</li>
            <li>API quota exhausted</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Check env keys and quotas</li>
            <li>Broaden the query</li>
            <li>Fallback to fewer results</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Playwright extraction fails">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Timeouts on `page.goto`</li>
            <li>Blank/empty content extracted</li>
            <li>Large memory usage</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Headless browser blocked or too strict resource blocking</li>
            <li>Selectors not found</li>
            <li>Batch size too large</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Adjust timeouts and blocked resources list</li>
            <li>Wait for `body` or main article container</li>
            <li>Lower concurrency/batch size</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Citations duplicated or noisy">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Repeated or irrelevant URLs</li>
            <li>Malformed links in output</li>
            <li>Unexpected images/assets captured</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Insufficient filtering of non-article URLs</li>
            <li>Regex over-matching</li>
            <li>Lack of deduplication</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Filter by file extensions and path patterns</li>
            <li>Tighten regex for `extract_citations`</li>
            <li>Deduplicate with ordered sets</li>
          </ul>
        </div>
      </Accordion>
    </AccordionGroup>
  </Tabs.Tab>
  <Tabs.Tab>
    <AccordionGroup>
      <Accordion title="No sitemap found">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Both `sitemap.xml` and `sitemap_index.xml` return 404</li>
            <li>Pipeline exits early</li>
            <li>No content types resolved</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Incorrect base URL</li>
            <li>Robots or server restrictions</li>
            <li>Timeouts during discovery</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Validate input URL format</li>
            <li>Try alternate discovery method</li>
            <li>Adjust timeouts/retries</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Partial URL discovery">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>URL count lower than expected</li>
            <li>Content types missing for some URLs</li>
            <li>Batch analysis completes too quickly</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Timeout path in `asyncio.wait_for`</li>
            <li>Deep sitemap nesting</li>
            <li>Rate limiting on target site</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Use partial results when timeout occurs</li>
            <li>Iterate nested indices</li>
            <li>Throttle batch size and delays</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Batch analysis memory pressure">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>High memory or process OOM</li>
            <li>Slowdowns during analysis</li>
            <li>System instability</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Batch size too large</li>
            <li>Unbounded result accumulation</li>
            <li>Inefficient parsing</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Lower batch size (e.g., 50 → 25)</li>
            <li>Stream results or paginate</li>
            <li>Profile and optimize hot paths</li>
          </ul>
        </div>
      </Accordion>
    </AccordionGroup>
  </Tabs.Tab>
  <Tabs.Tab>
    <AccordionGroup>
      <Accordion title="Editor toolbar not responsive">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Buttons no-op</li>
            <li>Formatting not applied</li>
            <li>Console warnings from BlockNote</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Version mismatch among BlockNote packages</li>
            <li>Context provider not mounted</li>
            <li>CSS collisions</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Align `@blocknote/*` versions</li>
            <li>Verify `EditorProvider` setup</li>
            <li>Scope editor styles</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Share/export fails">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Exported file empty</li>
            <li>Clipboard fails silently</li>
            <li>Download blocked by browser</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Missing permissions in browser</li>
            <li>Blob generation errors</li>
            <li>Pop-up/download blockers</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Enable clipboard/download permissions</li>
            <li>Validate blob/content creation</li>
            <li>Instruct users to allow pop-ups</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Real-time updates not visible">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>No activity in sidebars</li>
            <li>Expected SSE-driven events missing</li>
            <li>UI shows stale data</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>API base URL mismatch</li>
            <li>Event source not connected</li>
            <li>Auth token missing</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Confirm `VITE_API_BASE_URL`</li>
            <li>Check SSE subscription logic</li>
            <li>Verify auth store token retrieval</li>
          </ul>
        </div>
      </Accordion>
    </AccordionGroup>
  </Tabs.Tab>
  <Tabs.Tab>
    <AccordionGroup>
      <Accordion title="Unauthorized errors from API">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>401 on API requests</li>
            <li>Endpoints accessible without headers in dev tools</li>
            <li>Inconsistent auth state</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Missing JWT in request headers</li>
            <li>Mismatched token storage</li>
            <li>Stale token not refreshed (single-user mode)</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Ensure `Authorization: Bearer &lt;jwt&gt;` is set</li>
            <li>Validate `useAuthStore` integration</li>
            <li>Re-authenticate to refresh state</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="CORS issues between frontend and API">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Preflight failures</li>
            <li>Blocked requests in browser</li>
            <li>Different base URLs in code</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Incorrect `VITE_API_BASE_URL` vs actual API port</li>
            <li>Missing allowed origins</li>
            <li>Conflicting prefixes</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Align frontend base URL with Node `SERVER_PORT`</li>
            <li>Verify CORS configuration in Node/Python</li>
            <li>Check global prefix `seo-content-api` usage</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Webhook not receiving summaries">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Python logs show webhook attempts</li>
            <li>No content appears in app</li>
            <li>HTTP 4xx/5xx from webhook endpoint</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Incorrect `BASE_URL` or auth token</li>
            <li>Node route path/prefix mismatch</li>
            <li>Timeouts or firewall</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Confirm `BASE_URL` and `WEBHOOK_AUTH_TOKEN`</li>
            <li>Validate webhook route path and prefix</li>
            <li>Capture and inspect response bodies</li>
          </ul>
        </div>
      </Accordion>
    </AccordionGroup>
  </Tabs.Tab>
  <Tabs.Tab>
    <AccordionGroup>
      <Accordion title="High token or API cost">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Unexpected provider charges</li>
            <li>Long prompts/responses</li>
            <li>Frequent retries</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Large scraped content passed verbatim</li>
            <li>Multiple model calls per action</li>
            <li>Unbounded retries</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Truncate or summarize inputs</li>
            <li>Use fewer providers or cascade by need</li>
            <li>Set retry and temperature policies</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Slow scraping & analysis">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Long page loads</li>
            <li>Batch processing delays</li>
            <li>Low throughput</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Overly strict resource blocking</li>
            <li>High concurrency hitting limits</li>
            <li>Inefficient parsing</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Relax blocked resources or adjust waits</li>
            <li>Tune `CONCURRENT_REQUESTS` and batch sizes</li>
            <li>Profile selectors and parsing</li>
          </ul>
        </div>
      </Accordion>
      <Accordion title="Memory spikes during OCR or DOC conversion">
        <div>
          <strong>Symptoms</strong>
          <ul>
            <li>Process crashes on large PDFs</li>
            <li>DOC conversion fails</li>
            <li>Slow text extraction</li>
          </ul>
          <strong>Common causes</strong>
          <ul>
            <li>Large input files</li>
            <li>LibreOffice unavailable</li>
            <li>Non-zip DOCX sent</li>
          </ul>
          <strong>Solutions</strong>
          <ul>
            <li>Limit file sizes and paginate processing</li>
            <li>Install LibreOffice and validate path</li>
            <li>Verify DOCX is a valid archive</li>
          </ul>
        </div>
      </Accordion>
    </AccordionGroup>
  </Tabs.Tab>
</Tabs>

### Tech Stack

| Layer | Technologies | Purpose |
| --- | --- | --- |
| Frontend | React, Vite, React Router, React Query, Zustand, BlockNote, Tailwind | UI, editor, state, data fetching |
| Node API | NestJS, Mongoose, `@nestjs/*`, SSE, Helmet, CORS, Throttler | Core APIs, auth, rate limiting, streaming |
| Python API | FastAPI, Playwright, aiohttp, httpx, Crawl4AI | Scraping, sitemap analysis, SEO audit, AI orchestration |
| AI/LLM | OpenAI, Google Generative AI (Gemini), Anthropic (Claude), LangChain | Content generation and summarization |
| Storage | MongoDB (Mongoose + Motor) | Projects, articles, prompts, audits |
| Parsing/OCR | PyMuPDF, python-docx, LibreOffice CLI | Text extraction from documents |
| Utilities | Date-fns, Winston logging | Formatting and logging |

### Best practices

- **Validate inputs early**: Enforce ObjectId and payload validation at the edge.
- **Control concurrency**: Tune semaphore and batch sizes to avoid timeouts and memory pressure.
- **Truncate long contexts**: Summarize scraped text before sending to LLMs to reduce cost.
- **Harden scraping**: Block heavy assets, use timeouts and retries, and sanitize selectors.
- **Align API base/prefixes**: Keep `VITE_API_BASE_URL` and Node `SERVER_PORT` consistent; be mindful of the global prefix.
- **Instrument and log**: Use centralized logging and surface progress via SSE for UX and debugging.
- **Secure webhooks**: Verify `BASE_URL` and auth tokens; capture non-2xx responses.
- **Version alignment**: Keep BlockNote and Radix UI packages in sync to avoid UI issues.
